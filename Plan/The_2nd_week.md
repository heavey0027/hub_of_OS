
### 第2周：开发环境配置（4月4日–4月10日）

**需求分析**

- **目标**：配置开发环境以编译和运行内核。
- **功能需求**：
  - 安装RISC-V GNU工具链和QEMU。
  - 在QEMU中启动最小内核并显示控制台输出。
- **非功能需求**：确保环境可重现且稳定。

**系统设计**

- **组件**：

  - 交叉编译器：`riscv64-unknown-elf-gcc`。
  - 模拟器：QEMU的RISC-V Virt机器。
  - 链接脚本：定义内核内存布局。

- **图示**：

  ```
  [源代码] -> [交叉编译器] -> [内核二进制文件] -> [QEMU模拟器]
  ```

**实现细节**

- 在Ubuntu上安装RISC-V GNU工具链和QEMU。

- 配置QEMU使用`virt`机器支持RISC-V。

- 编写简单的链接脚本（`linker.ld`）以指定内核内存位置。

- **关键代码**：

  ```ld
  /* linker.ld */
  SECTIONS {
      . = 0x80000000;
      .text : { *(.text) }
      .data : { *(.data) }
      .bss : { *(.bss) }
  }
  ```

**测试结果**

- **测试用例1**：使用RISC-V工具链编译简单C程序。
  - **结果**：成功编译并链接测试二进制文件。
- **测试用例2**：运行QEMU（`virt`机器）并验证输出。
  - **结果**：QEMU启动成功，但无输出（内核尚未完全实现）。
- **截图**：QEMU窗口显示初始化（暂无输出）。

**总结与反思**

- **成果**：搭建开发环境，测试工具链。
- **挑战**：配置QEMU参数较复杂，通过参考RISC-V QEMU教程解决。
- **改进建议**：下周实现启动流程以显示实际输出。
