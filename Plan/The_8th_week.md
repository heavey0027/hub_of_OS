#### 第8周：功能测试和验证（5月16日–5月22日）

**需求分析**

- **目标**：验证系统调用、内存管理和用户程序执行。
- **功能需求**：
  - 确保用户程序通过`sys_write`输出正确。
  - 验证内存分配和中断处理稳定性。
- **非功能需求**：实现稳定执行，减少崩溃。

**系统设计**

- **组件**：

  - 测试套件：简单C程序测试系统调用和内存。
  - 调试框架：添加日志跟踪执行。

- **图示**：

  ```
  [用户测试程序] -> [sys_write] -> [UART输出]
  [内核测试] -> [内存/中断验证]
  ```

**实现细节**

- 修复第7周的页面表问题以启用用户模式。

- 编写测试用户程序调用`sys_write`。

- **关键代码**：

  ```c
  // test_user.c
  void main() {
      asm volatile ("li a7, 1\n"  // 系统调用号为write
                    "li a0, 0x80030000\n"  // 缓冲区地址
                    "ecall");
  }
  ```

**测试结果**

- **测试用例1**：运行用户程序通过`sys_write`打印“Hello World”。
  - **结果**：成功在QEMU中输出“Hello World”。
- **测试用例2**：分配多个页面，验证无重叠。
  - **结果**：成功分配20个页面，无错误。
- **测试用例3**：在用户执行期间触发定时器中断。
  - **结果**：中断处理正确，无崩溃。
- **截图**：QEMU输出显示“Hello World”和调试日志。

**总结与反思**

- **成果**：成功执行用户程序并验证核心功能。
- **挑战**：调试页面表耗时，通过简化映射解决。
- **改进建议**：增强测试用例，准备第三阶段的进程管理。